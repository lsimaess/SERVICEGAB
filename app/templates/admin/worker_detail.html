{% extends "base.html" %}
{% block title %}Détails du Travailleur{% endblock %}
{% block titlebar %}Modifier le Travailleur{% endblock %}

{% block content %}
<style>
  /* [Same styles as before, unchanged for brevity] */
</style>

<div class="form-wrapper">
  <form method="POST" enctype="multipart/form-data">
    {{ form.hidden_tag() }}

    {% if worker.profile_picture_url %}
    <div class="text-center">
      <img src="{{ worker.profile_picture_url }}" alt="Photo de profil" class="preview-img">
    </div>
    {% endif %}

    <p class="text-muted">
      <strong>Statut actuel :</strong> {{ worker.status.capitalize() }}
    </p>

    <!-- 🧾 Informations de base -->
    <h6 class="form-section-title">Informations de base</h6>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">{{ form.first_name.label.text }}</label>
        {{ form.first_name(class="form-control", placeholder="Prénom") }}
        {% for e in form.first_name.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        <label class="form-label">{{ form.last_name.label.text }}</label>
        {{ form.last_name(class="form-control", placeholder="Nom") }}
        {% for e in form.last_name.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>

      <div class="col-md-12">
        <label class="form-label">{{ form.email.label.text }}</label>
        {{ form.email(class="form-control", placeholder="Adresse email (facultative)") }}
        {% for e in form.email.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <p class="mt-3 text-muted">
      <strong>Nom complet :</strong>
      {{ (form.first_name.data or worker.first_name) ~ ' ' ~ (form.last_name.data or worker.last_name) }}
    </p>

    <!-- 📞 Coordonnées -->
    <h6 class="form-section-title">Coordonnées</h6>
    <div class="row g-3">
      <div class="col-md-4">
        <label class="form-label">{{ form.country_code.label.text }}</label>
        {{ form.country_code(class="form-select") }}
        {% for e in form.country_code.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-8">
        <label class="form-label">{{ form.phone_number.label.text }}</label>
        {{ form.phone_number(class="form-control", placeholder="0X XX XX XX") }}
        {% for e in form.phone_number.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <!-- 🌍 Localisation -->
    <h6 class="form-section-title">Localisation</h6>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">{{ form.zone.label.text }}</label>
        {{ form.zone(class="form-select") }}
        {% for e in form.zone.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        <label class="form-label">{{ form.city.label.text }}</label>
        {{ form.city(class="form-control", placeholder="Ville") }}
        {% for e in form.city.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <!-- 🛠️ Métier & Expérience -->
    <h6 class="form-section-title">Métier & Expérience</h6>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">{{ form.job_primary_id.label.text }}</label>
        {{ form.job_primary_id(class="form-select") }}
        {% for e in form.job_primary_id.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        <label class="form-label">{{ form.job_secondary_id.label.text }}</label>
        {{ form.job_secondary_id(class="form-select") }}
        <div class="form-text">Choisissez « — Aucun — » si non applicable.</div>
        {% for e in form.job_secondary_id.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <div class="row g-3 mt-1">
      <div class="col-md-6">
        <label class="form-label">{{ form.experience_years.label.text }}</label>
        {{ form.experience_years(class="form-control", placeholder="Années d'expérience") }}
        {% for e in form.experience_years.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        <label class="form-label">{{ form.salary_per_job.label.text }}</label>
        {{ form.salary_per_job(class="form-control", placeholder="ex: 10 000") }}
        {% for e in form.salary_per_job.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <div class="mt-3">
      <label class="form-label">{{ form.bio.label.text }}</label>
      {{ form.bio(class="form-control", rows="4", placeholder="Brève biographie...") }}
      {% for e in form.bio.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
    </div>

    <div class="mt-3">
      <label class="form-label">{{ form.source.label.text }}</label>
      {{ form.source(class="form-select") }}
      {% for e in form.source.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
    </div>

    <!-- 📎 Fichiers -->
    <h6 class="form-section-title">Fichiers</h6>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">{{ form.profile_picture.label.text }}</label>
        {{ form.profile_picture(class="form-control") }}
        <div class="form-text">Formats: jpg, jpeg, png</div>
        {% for e in form.profile_picture.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
      <div class="col-md-6">
        <label class="form-label">{{ form.id_document.label.text }}</label>
        {{ form.id_document(class="form-control") }}
        <div class="form-text">Formats: pdf, jpg, png</div>
        {% for e in form.id_document.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
      </div>
    </div>

    <!-- ✅ Boutons d'action -->
    <div class="action-buttons">
      <button type="submit" class="btn btn-primary">
        <i class="bi bi-check-circle"></i> Enregistrer
      </button>
      <a href="{{ url_for('admin.admin_worker_list') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left-circle"></i> Retour à la liste
      </a>
    </div>
  </form>
</div>
{% endblock %}
